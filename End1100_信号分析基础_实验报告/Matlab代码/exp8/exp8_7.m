clc;
Fs=4000;
t=0:1/Fs:1;
x=sin(2*pi*20*t)+sin(2*pi*100*t)+sin(2*pi*200*t);
%低通滤波器设计：
wp=2*30/Fs;
ws=2*60/Fs;
Rp=1;
As=30;
subplot(331);
plot(t,x);
title('原始信号');
[N,wc]=buttord(wp,ws,Rp,As);
[B,A]=butter(N,wc);
[H,W]=freqz(B,A);
y=filter(B,A,x);
subplot(334);
plot(W,abs(H));
title('低通滤波器');
subplot(337);
plot(t,y)
title('30Hz信号');
%高通滤波器设计：
wp=2*170/Fs;
ws=2*120/Fs;
Rp=20;
As=50;
subplot(332);
plot(t,x);
title('原始信号');
[N,wc]=buttord(wp,ws,Rp,As);
[B,A]=butter(N,wc,'high');
[H,W]=freqz(B,A);
y=filter(B,A,x);
subplot(335);
plot(W,abs(H));
title('高通滤波器');
subplot(338);
plot(t,y);
title('200Hz信号');
%带通滤波器设计：
fp=[70 130];fs=[30 170];
wp=2*fp/Fs; ws=2*fs/Fs;rp=0.5;rs=50;
subplot(333);
plot(t,x);
title('原始信号');
[N,wc]=ellipord(wp,ws,rp,rs);
[B,A]=ellip(N,rp,rs,wc);
[H,w]=freqz(B,A);

y=filter(B,A,x);
subplot(336);
plot(W,abs(H));
title('带通滤波器');
subplot(339);
plot(t,y);
title('100Hz信号');